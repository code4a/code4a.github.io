<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[蒋彦涛的个人博客]]></title>
  <subtitle><![CDATA[Code 4 Android / ...]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://www.code4a.com/"/>
  <updated>2016-03-15T05:32:15.000Z</updated>
  <id>http://www.code4a.com/</id>
  
  <author>
    <name><![CDATA[code4a]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[使用NanoHTTPD在Android上建立本地服务器]]></title>
    <link href="http://www.code4a.com/2016/03/11/NanoHTTPD-Simple-Use/"/>
    <id>http://www.code4a.com/2016/03/11/NanoHTTPD-Simple-Use/</id>
    <published>2016-03-11T10:22:51.000Z</published>
    <updated>2016-03-15T05:32:15.000Z</updated>
    <content type="html"><![CDATA[<h2 id="使用NanoHTTPD在Android上建立本地服务器">使用NanoHTTPD在Android上建立本地服务器</h2><blockquote>
<p>因为项目需求，需要在Android端的Service上实现一个简单的服务器，方便客户端发送Http请求，完成对应的自动化流程，<br>通过查阅相关资料，最终决定采用NanoHTTPD</p>
</blockquote>
<ul>
<li><h4 id="NanoHTTPD项目地址"><a href="https://github.com/NanoHttpd/nanohttpd" target="_blank" rel="external">NanoHTTPD项目地址</a></h4></li>
</ul>
<p>在 <strong><a href="https://github.com/NanoHttpd/nanohttpd/releases" target="_blank" rel="external">releases</a></strong> 界面下载nanohttpd-2.2.0.jar导入eclipse的工程中，因为目前的项目是迭代早期的项目，而且也并未往Android Studio上迁移，在AS上的依赖可以参考项目的  <strong><a href="https://github.com/NanoHttpd/nanohttpd/blob/master/README.md" target="_blank" rel="external">Readme</a></strong> 进行配置</p>
<p>使用起来非常的简单，服务端的代码实现如下：</p>
<h4 id="1-_单独的类集成NanoHTTPD">1. 单独的类集成NanoHTTPD</h4><pre><code><span class="keyword">package</span> com.cmcc.receiver.transfer;

<span class="keyword">import</span> java.util.<span class="keyword">HashMap</span>;
<span class="keyword">import</span> java.util.Map;
<span class="keyword">import</span> java.util.Set;

<span class="keyword">import</span> android.os.Handler;
<span class="keyword">import</span> android.os.Message;
<span class="keyword">import</span> android.<span class="built_in">text</span>.TextUtils;
<span class="keyword">import</span> android.util.Log;

<span class="keyword">import</span> com.cmcc.receiver.consts.Constants;

<span class="keyword">import</span> fi.iki.elonen.NanoHTTPD;

<span class="keyword">public</span> class WiMoTransferServer extends NanoHTTPD {

  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">int</span> DEFAULT_SERVER_PORT = <span class="number">8080</span>;
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> TAG = WiMoTransferServer.class.getSimpleName();

  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> NOTHING = <span class="string">"/favicon.ico"</span>;

  <span class="comment">// ip:8080/cmd=set_interent&amp;target_ssid=WiMO-<span class="label">xxxx&amp;password=12345678</span></span>
  <span class="comment">// cmd=set_interent&amp;target_ssid=netgear54&amp;password=11111111</span>

  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> REQUEST_ROOT = <span class="string">"/"</span>;

  <span class="keyword">private</span> Handler mHander;

  <span class="keyword">public</span> WiMoTransferServer(Handler mHandler) {
      <span class="keyword">super</span>(DEFAULT_SERVER_PORT);
      <span class="keyword">this</span>.mHander = mHandler;
  }

  @Override
  <span class="keyword">public</span> Response serve(IHTTPSession session) {
      <span class="comment">// TODO Auto-generated method stub</span>
      Log.i(TAG, <span class="string">"IHTTPSession : -&gt; "</span> + session.getMethod() + <span class="string">" , uri : -&gt; "</span> + session.getUri());
      Response response = <span class="keyword">super</span>.serve(session);
      <span class="keyword">String</span> uriStr = session.getUri();
      <span class="keyword">switch</span> (session.getMethod()) {
      <span class="keyword">case</span> GET:
          <span class="keyword">if</span> (NOTHING.equals(uriStr) || REQUEST_ROOT.equals(uriStr)) {
              Log.i(TAG, <span class="string">"request url = "</span> + NOTHING);
              response = response404(session, uriStr);
          } <span class="keyword">else</span> <span class="keyword">if</span> (!TextUtils.isEmpty(uriStr) &amp;&amp; uriStr.contains(Constants.EQUAL)) {
              Map&lt;<span class="keyword">String</span>, <span class="keyword">String</span>&gt; paramsMap = parseURLRequest(uriStr);
              checkParamsResult(paramsMap);
              <span class="keyword">String</span> cmdResult = paramsMap.<span class="built_in">get</span>(Constants.CMD);
              Log.i(TAG, <span class="string">" cmdResult -&gt; "</span> + cmdResult);
              <span class="keyword">if</span> (!TextUtils.isEmpty(cmdResult) &amp;&amp; Constants.SETINTERNET.equals(cmdResult)) {
                  <span class="keyword">String</span> targetSSID = paramsMap.<span class="built_in">get</span>(Constants.TARGETSSID);
                  <span class="keyword">String</span> pwd = paramsMap.<span class="built_in">get</span>(Constants.PWD);
                  Log.i(TAG, <span class="string">"targetSSID = "</span> + targetSSID + <span class="string">" ,password = "</span> + pwd);
                  Message msg = mHander.obtainMessage(Constants.MSG_CONNECT_TARGET_AP);
                  msg.obj = targetSSID + Constants.SPLIT + pwd;
                  mHander.sendMessage(msg);
              }
              response = responseSuccess();
          }

          <span class="comment">// default:</span>
          <span class="comment">// Log.i(TAG, "request method is not GET");</span>
          <span class="comment">// response = response404(session, uriStr);</span>
          <span class="comment">// break;</span>
      }
      <span class="keyword">return</span> response;
  }

  <span class="keyword">public</span> <span class="keyword">void</span> checkParamsResult(Map&lt;<span class="keyword">String</span>, <span class="keyword">String</span>&gt; paramsMap) {
      Set&lt;<span class="keyword">String</span>&gt; keySet = paramsMap.keySet();
      <span class="keyword">for</span> (<span class="keyword">String</span> <span class="variable">key</span> : keySet) {
          <span class="keyword">String</span> value = paramsMap.<span class="built_in">get</span>(<span class="variable">key</span>);
          Log.i(TAG, <span class="string">"params_Key: -&gt; "</span> + <span class="variable">key</span> + <span class="string">" ,params_Value: -&gt; "</span> + value);
      }
  }

  <span class="comment">/**
   * 解析出url参数中的键值对 如
   * "ip:8080/cmd=set_interent&amp;target_ssid=WiMO-xxxx&amp;password=12345678"，
   * 解析出cmd:set_interent,target_ssid:WiMO-xxxx,password:12345678存入map中
   *
   * @param URL
   *            url地址
   * @return url请求参数部分
   */</span>
  <span class="keyword">public</span> Map&lt;<span class="keyword">String</span>, <span class="keyword">String</span>&gt; parseURLRequest(<span class="keyword">String</span> URL) {
      Map&lt;<span class="keyword">String</span>, <span class="keyword">String</span>&gt; mapRequest = <span class="keyword">new</span> <span class="keyword">HashMap</span>&lt;<span class="keyword">String</span>, <span class="keyword">String</span>&gt;();

      <span class="keyword">String</span>[] arrSplit = <span class="keyword">null</span>;

      <span class="keyword">String</span> strUrlParam = truncateUrlPage(URL);
      <span class="keyword">if</span> (strUrlParam == <span class="keyword">null</span>) {
          <span class="keyword">return</span> mapRequest;
      }
      <span class="comment">// 每个键值为一组</span>
      arrSplit = strUrlParam.<span class="built_in">split</span>(<span class="string">"[&amp;]"</span>);
      <span class="keyword">for</span> (<span class="keyword">String</span> strSplit : arrSplit) {
          <span class="keyword">String</span>[] arrSplitEqual = <span class="keyword">null</span>;
          arrSplitEqual = strSplit.<span class="built_in">split</span>(<span class="string">"[=]"</span>);

          <span class="comment">// 解析出键值</span>
          <span class="keyword">if</span> (arrSplitEqual.length &gt; <span class="number">1</span>) {
              <span class="comment">// 正确解析</span>
              mapRequest.put(arrSplitEqual[<span class="number">0</span>], arrSplitEqual[<span class="number">1</span>]);

          } <span class="keyword">else</span> {
              <span class="keyword">if</span> (arrSplitEqual[<span class="number">0</span>] != <span class="string">""</span>) {
                  <span class="comment">// 只有参数没有值，不加入</span>
                  mapRequest.put(arrSplitEqual[<span class="number">0</span>], <span class="string">""</span>);
              }
          }
      }
      <span class="keyword">return</span> mapRequest;
  }

  <span class="comment">/**
   * 去掉url中的路径，留下请求参数部分
   *
   * @param strURL
   *            url地址
   * @return url请求参数部分
   */</span>
  <span class="keyword">public</span> <span class="keyword">String</span> truncateUrlPage(<span class="keyword">String</span> strURL) {
      <span class="keyword">String</span> strAllParam = <span class="keyword">null</span>;
      <span class="keyword">String</span>[] arrSplit = <span class="keyword">null</span>;

      strURL = strURL.<span class="built_in">trim</span>().toLowerCase();

      <span class="keyword">if</span> (strURL.contains(<span class="string">"[?]"</span>)) {
          arrSplit = strURL.<span class="built_in">split</span>(<span class="string">"[?]"</span>);
          <span class="keyword">if</span> (strURL.length() &gt; <span class="number">1</span>) {
              <span class="keyword">if</span> (arrSplit.length &gt; <span class="number">1</span>) {
                  <span class="keyword">if</span> (arrSplit[<span class="number">1</span>] != <span class="keyword">null</span>) {
                      strAllParam = arrSplit[<span class="number">1</span>];
                  }
              }
          }
      } <span class="keyword">else</span> <span class="keyword">if</span> (strURL.startsWith(REQUEST_ROOT)) {
          strAllParam = strURL.substring(strURL.indexOf(REQUEST_ROOT) + <span class="number">1</span>);
          Log.i(TAG, <span class="string">" strAllParam substring result : -&gt; "</span> + strAllParam);
      } <span class="keyword">else</span> {
          strAllParam = strURL;
      }

      <span class="keyword">return</span> strAllParam;
  }

  <span class="keyword">public</span> Response responseSuccess() {
      StringBuilder builder = <span class="keyword">new</span> StringBuilder();
      builder.<span class="built_in">append</span>(<span class="string">"&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;"</span>);
      builder.<span class="built_in">append</span>(<span class="string">"Success!"</span>);
      builder.<span class="built_in">append</span>(<span class="string">"&lt;/body&gt;&lt;/html&gt;\n"</span>);
      <span class="keyword">return</span> newFixedLengthResponse(builder.toString());
  }

  <span class="keyword">public</span> Response response404(IHTTPSession session, <span class="keyword">String</span> url) {
      StringBuilder builder = <span class="keyword">new</span> StringBuilder();
      builder.<span class="built_in">append</span>(<span class="string">"&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;"</span>);
      builder.<span class="built_in">append</span>(<span class="string">"Sorry, Can't Found "</span> + url + <span class="string">" !"</span>);
      builder.<span class="built_in">append</span>(<span class="string">"&lt;/body&gt;&lt;/html&gt;\n"</span>);
      <span class="keyword">return</span> newFixedLengthResponse(builder.toString());
  }
}
</code></pre><h4 id="2-_在service中初始化WiMoTransferServer对象">2. 在service中初始化WiMoTransferServer对象</h4><pre><code><span class="keyword">private</span> <span class="function"><span class="keyword">void</span> <span class="title">initWebServer</span><span class="params">()</span> </span>{
    mWiMoTransferServer = <span class="keyword">new</span> WiMoTransferServer(mHandler);
    <span class="keyword">try</span> {
        mWiMoTransferServer.start();
    } <span class="keyword">catch</span> (IOException e) {
        e.printStackTrace();
    }
}
</code></pre><p>  在需要初始化server的地方调用该方法，在需要停止服务的地方调用</p>
<pre><code>mWiMoTransferServer.<span class="literal">stop</span>();
</code></pre><h4 id="3-_然后再客户端中通过http请求发送到该服务的ip地址，然后再做详细的处理和响应">3. 然后再客户端中通过http请求发送到该服务的ip地址，然后再做详细的处理和响应</h4>]]></content>
    <summary type="html">
    <![CDATA[<h2 id="使用NanoHTTPD在Android上建立本地服务器">使用NanoHTTPD在Android上建立本地服务器</h2><blockquote>
<p>因为项目需求，需要在Android端的Service上实现一个简单的服务器，方便客户端发送Http请求，完成对]]>
    </summary>
    
      <category term="NanoHTTPD" scheme="http://www.code4a.com/tags/NanoHTTPD/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[RxJava学习笔记(一)]]></title>
    <link href="http://www.code4a.com/2016/03/10/RxJava-Study-first/"/>
    <id>http://www.code4a.com/2016/03/10/RxJava-Study-first/</id>
    <published>2016-03-10T15:31:02.000Z</published>
    <updated>2016-03-10T16:56:14.000Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>由于目前工作比较安逸，成了温水青蛙，长期以往的惰性，导致了好多新知识还停留在听过的阶段，作为一个软件工程师来说，这是致命的缺点.<br>为了重拾原有的拼劲和热情，所以自己决定做出改变，就以当下比较流程的RxJava的学习去转变！丰富自己技能的同时，也养成坚持写博客的习惯！</p>
</blockquote>
<ul>
<li><p><strong><a href="https://github.com/ReactiveX/RxJava" target="_blank" rel="external">RxJava项目地址</a></strong></p>
</li>
<li><p>关于RxJava的简介和优点可以参考</p>
</li>
<li><p><strong><a href="http://mrfu.me/android/2015/11/11/Getting_Started_with_RxJava_and_Android/" target="_blank" rel="external">RxJava 入门</a></strong></p>
</li>
</ul>
<h3 id="1-准备工作">1.准备工作</h3><blockquote>
<p>工欲善其事，必先利其器</p>
</blockquote>
<p>  a.首先打开Android Studio创建项目，然后根据RxJava的Readme中描述在AS中的使用方法</p>
<p>  Example for Gradle:</p>
<pre><code><span class="keyword">compile</span> <span class="string">'io.reactivex:rxjava:x.y.z'</span>
</code></pre><p>  b.然后再项目的Module的根目录<code>build.gradle</code>文件中添加项目依赖，查看Github中Release分支中看到的RxJava版本为1.1.1, 所以最终添加的内容</p>
<pre><code><span class="keyword">compile</span> <span class="string">'io.reactivex:rxjava:1.1.1'</span>
</code></pre><p>  然后点击上边的出现的 <code>Sync Now</code> 等待依赖下载完成，即准备工作完成</p>
<h3 id="2-牛刀小试">2.牛刀小试</h3><blockquote>
<p>敲码百变，其义自现</p>
</blockquote>
<p>  a.Hello Wrold</p>
<ul>
<li><p>先创建Observable</p>
<pre><code>rx.Observable&lt;String&gt; myObservable = rx.Observable.create(
      new rx.Observable.OnSubscribe&lt;String&gt;() {
          <span class="variable">@Override</span>
          public void call(rx.Subscriber&lt;? super String&gt; <span class="sub"><span class="keyword">sub</span>) {</span>
              <span class="sub"><span class="keyword">sub</span>.onNext("Hello, world!");</span>
              <span class="sub"><span class="keyword">sub</span>.onCompleted();</span>
          }
      }
);
</code></pre></li>
<li><p>Observable发送“Hello,world!”消息然后完成。接着创建Subscriber来消费这个数据：</p>
<pre><code><span class="literal">rx</span><span class="built_in">.</span>Subscriber&lt;<span class="built_in">String</span>&gt; mySubscriber = <span class="literal">new</span> <span class="literal">rx</span><span class="built_in">.</span>Subscriber&lt;<span class="built_in">String</span>&gt;() {
    @Override
    <span class="keyword">public</span> <span class="literal">void</span> onNext(<span class="built_in">String</span> s) {
        <span class="keyword">Log</span><span class="built_in">.</span>i(<span class="built_in">TAG</span>, <span class="string">" s -&gt; "</span> + s);
    }

    @Override
    <span class="keyword">public</span> <span class="literal">void</span> onCompleted() {
        <span class="keyword">Log</span><span class="built_in">.</span>i(<span class="built_in">TAG</span>, <span class="string">" onCompleted() "</span>);
    }

    @Override
    <span class="keyword">public</span> <span class="literal">void</span> onErr<span class="subst">or</span>(Throwable e) {
    }
};
</code></pre></li>
<li><p>上面代码所做的工作就是打印由Observable发送的字符串。现在我们有了myObservable和mySubscriber，就可以通过subscribe()函数把两者关联起来：</p>
<pre><code><span class="tag">myObservable</span><span class="class">.subscribe</span>(<span class="tag">mySubscriber</span>);
</code></pre></li>
<li><p>当订阅完成，myObservable将调用subscriber的onNext()和onComplete()函数，最终mySubscriber打印“Hello, world!”然后终止。</p>
<pre><code><span class="number">03</span>-<span class="number">10</span> <span class="number">11</span>:<span class="number">55</span>:<span class="number">42.784</span> <span class="number">4249</span>-<span class="number">4249</span>/com.code4a I/HiddenTitleActivity:  s -&gt; Hello, world!
<span class="number">03</span>-<span class="number">10</span> <span class="number">11</span>:<span class="number">55</span>:<span class="number">42.784</span> <span class="number">4249</span>-<span class="number">4249</span>/com.code4a I/HiddenTitleActivity:  onCompleted() 
</code></pre></li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<blockquote>
<p>由于目前工作比较安逸，成了温水青蛙，长期以往的惰性，导致了好多新知识还停留在听过的阶段，作为一个软件工程师来说，这是致命的缺点.<br>为了重拾原有的拼劲和热情，所以自己决定做出改变，就以当下比较流程的RxJava的学习去转变！丰富自己技能的同时，]]>
    </summary>
    
      <category term="RxJava" scheme="http://www.code4a.com/tags/RxJava/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Better Java(一)]]></title>
    <link href="http://www.code4a.com/2015/11/16/better-java/"/>
    <id>http://www.code4a.com/2015/11/16/better-java/</id>
    <published>2015-11-16T13:04:04.000Z</published>
    <updated>2015-11-16T15:50:40.000Z</updated>
    <content type="html"><![CDATA[<h2 id="教你编写现代化的java程式">教你编写现代化的java程式</h2><blockquote>
<p>Java是目前世界上最流行的编程语言之一，自从java8正式发布之后，原有的编程习惯方式发生了一些转变。</p>
</blockquote>
<h3 id="Style(样式)"><strong>Style(样式)</strong></h3><ul>
<li>传统而言，java是习惯以冗长的javaBean方式定义某个数据对象，新的样式可能会更清晰和保证准确性</li>
</ul>
<h4 id="Structs(结构体)">Structs(结构体)</h4><ul>
<li><h5 id="常规用法">常规用法</h5><pre><code><span class="keyword">public</span> class DataBean {

  <span class="keyword">private</span> <span class="built_in">String</span> <span class="built_in">data</span>;

  <span class="keyword">public</span> DataBean(){};

  <span class="keyword">public</span> <span class="literal">void</span> setData(<span class="built_in">String</span> <span class="built_in">data</span>){
    this<span class="built_in">.</span><span class="built_in">data</span> = <span class="built_in">data</span>;
  }

  <span class="keyword">public</span> <span class="built_in">String</span> getData(){
    <span class="keyword">return</span> this<span class="built_in">.</span><span class="built_in">data</span>;
  }
}
</code></pre></li>
<li><h5 id="不过这种方式是冗长并且浪费资源的，即便你的编辑器能自动生成这种代码。作为替代方法，可以参考C风格里的结构体样式去编写这种容器数据：">不过这种方式是冗长并且浪费资源的，即便你的编辑器能自动生成这种代码。作为替代方法，可以参考<code>C</code>风格里的结构体样式去编写这种容器数据：</h5><pre><code><span class="keyword">public</span> <span class="keyword">class</span> DataBean {
    <span class="keyword">public</span> <span class="keyword">final</span> String <span class="type">data</span>;

    <span class="keyword">public</span> DataBean(String <span class="type">data</span>) {
        this.<span class="type">data</span> = <span class="type">data</span>;
    }
}
</code></pre></li>
<li><h5 id="这种方式几乎可以使得代码行数减半，除此之外，这种类还是不可变得类，所以在某些情况下我们可以放心的使用它。如果你是希望用Map或者List这些结构体去存储对象而使得修改变得简单点，可以使用ImmuTableMap或者ImmuTableList。这个后边会讨论。">这种方式几乎可以使得代码行数减半，除此之外，这种类还是不可变得类，所以在某些情况下我们可以放心的使用它。如果你是希望用Map或者List这些结构体去存储对象而使得修改变得简单点，可以使用ImmuTableMap或者ImmuTableList。这个后边会讨论。</h5></li>
</ul>
<h4 id="Builder模式">Builder模式</h4><ul>
<li><h5 id="如果你的数据元结构比较复杂，那么你可以考虑如下Builder模式。Builder模式在数据类构造器中定义了一个子类，使用可变状态，不过一旦创建之后就会变得不可改变：">如果你的数据元结构比较复杂，那么你可以考虑如下Builder模式。Builder模式在数据类构造器中定义了一个子类，使用可变状态，不过一旦创建之后就会变得不可改变：</h5><pre><code><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ComplicatedDataBean</span> </span>{
    <span class="keyword">public</span> <span class="keyword">final</span> String data;
    <span class="keyword">public</span> fianl <span class="keyword">int</span> num;
    <span class="comment">// lots more fields and a constructor</span>
    <span class="function"><span class="keyword">private</span> <span class="title">ComplicatedDataBean</span><span class="params">(Builder builder)</span></span>{
        <span class="keyword">this</span>.data = builder.data;
        <span class="keyword">this</span>.num = builder.num;
    }

    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span> </span>{
        <span class="keyword">private</span> String data;
        <span class="keyword">private</span> <span class="keyword">int</span> num;

        <span class="function"><span class="keyword">public</span> Builder <span class="title">data</span><span class="params">(String data)</span> </span>{
            <span class="keyword">this</span>.data = data;
            <span class="keyword">return</span> <span class="keyword">this</span>;
        }

        <span class="function"><span class="keyword">public</span> Builder <span class="title">num</span><span class="params">(<span class="keyword">int</span> num)</span></span>{
            <span class="keyword">this</span>.num = num;
            <span class="keyword">return</span> <span class="keyword">this</span>;
        }

        <span class="function"><span class="keyword">public</span> ComplicatedDataBean <span class="title">build</span><span class="params">()</span></span>{
            <span class="keyword">return</span> <span class="keyword">new</span> ComplicatedDataBean(<span class="keyword">this</span>); <span class="comment">// etc</span>
        }
    }
}
</code></pre></li>
<li><h5 id="然后可以按照如下方式使用：">然后可以按照如下方式使用：</h5><pre><code><span class="keyword">final</span> ComplicatedDataBean cda = <span class="keyword">new</span> ComplicatedDataBean.builder().data(<span class="string">"她已经"</span>).<span class="built_in">num</span>(<span class="number">22</span>).build();
</code></pre></li>
</ul>
<h4 id="Dependency_Injection(依赖注入)">Dependency Injection(依赖注入)</h4><ul>
<li><h5 id="依赖注入更多的从属于软件工程的范畴而并非java的范畴，但是去撰写可测试的软件的最好方式就是使用依赖注入。因为java强烈推荐OO的设计方式，为了使软件具有较好的可测试性，可以去使用依赖注入。">依赖注入更多的从属于软件工程的范畴而并非java的范畴，但是去撰写可测试的软件的最好方式就是使用依赖注入。因为java强烈推荐OO的设计方式，为了使软件具有较好的可测试性，可以去使用依赖注入。</h5></li>
<li><h5 id="在java领域，最经典的DI框架当属Spring，它提供了基于代码的注入以及基于xml配置的注入方式。不过Spring确实有些繁琐，如果只是单纯的想使用依赖注入这个功能，可以选择使用Google_和_Square的Dagger库或者Google’s_Guice-">在java领域，最经典的DI框架当属Spring，它提供了基于代码的注入以及基于xml配置的注入方式。不过Spring确实有些繁琐，如果只是单纯的想使用依赖注入这个功能，可以选择使用Google 和 Square的Dagger库或者Google’s Guice.</h5></li>
</ul>
<h4 id="避免空指针">避免空指针</h4><ul>
<li><h5 id="尽可能的避免使用空指针。特别是在可能返回空的集合的情况下，务必返回一个内容为空的集合而不是null。如果使用的是java8，可以使用新的Optional类型来避免可能的空指针。">尽可能的避免使用空指针。特别是在可能返回空的集合的情况下，务必返回一个内容为空的集合而不是null。如果使用的是java8，可以使用新的Optional类型来避免可能的空指针。</h5><pre><code><span class="keyword">public</span> <span class="keyword">class</span> FooWidget {
    <span class="keyword">private</span> <span class="keyword">final</span> String <span class="type">data</span>;
    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Optional</span>&lt;Bar&gt; bar;

    <span class="keyword">public</span> FooWidget(String <span class="type">data</span>){
        this(<span class="type">data</span>, <span class="type">Optional</span>.empty());
    }

    <span class="keyword">public</span> FooWidget(String <span class="type">data</span>, <span class="type">Optional</span>&lt;Bar&gt; bar){
        this.<span class="type">data</span> = <span class="type">data</span>;
        this.bar = bar;
    }

    <span class="keyword">public</span> <span class="type">Optional</span>&lt;Bar&gt; getBar(){
        <span class="keyword">return</span> bar;
    }
}
</code></pre></li>
<li><h5 id="根据上述代码可知道，返回的数据肯定不会为null类型，不过bar不一定是present(存在)的">根据上述代码可知道，返回的数据肯定不会为null类型，不过bar不一定是present(存在)的</h5><pre><code><span class="keyword">final</span> Optional&lt;FooWidget&gt; fooWidget = maybeGetFooWidget();
<span class="keyword">final</span> Baz baz = fooWidget.flatMap(FooWidget::getBar).flatMap(BarWidget::getBaz).orElse(defaultBaz);
</code></pre></li>
</ul>
<h4 id="ImmuTable-by-default(默认不可变)">ImmuTable-by-default(默认不可变)</h4><blockquote>
<p>java-advantages-of-of-immutable-objects-in-examples</p>
</blockquote>
<ul>
<li><h5 id="除非有特殊的原因，否则变量，类，集合应该默认设置为不可变。其中变量类型可以使用final关键字设置不可变：">除非有特殊的原因，否则变量，类，集合应该默认设置为不可变。其中变量类型可以使用final关键字设置不可变：</h5><pre><code><span class="keyword">final</span> FooWidget fooWidget;
<span class="keyword">if</span>(condition()){
    fooWidget = getWidget();
}<span class="keyword">else</span>{
    <span class="keyword">try</span>{
        fooWidget = cachedFooWidget.<span class="keyword">get</span>();
    }<span class="keyword">catch</span>(CachingException e){
        <span class="keyword">throw</span> e;
    }
}
</code></pre><p><img src="http://code4a.github.io/bimg/better-java-picture1.png" alt="ImmuTable-by-default"></p>
</li>
</ul>
<h4 id="Avoid_lots_of_Util_Classes(避免使用大量工具类)">Avoid lots of Util Classes(避免使用大量工具类)</h4><ul>
<li><h5 id="一不注意，就会发现自己写了N多的工具类，譬如：">一不注意，就会发现自己写了N多的工具类，譬如：</h5><pre><code><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MiscUtil</span> {
  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">frobnicateString</span>(<span class="params">String <span class="keyword">base</span>, <span class="keyword">int</span> times</span>)</span>{
  <span class="comment">// ... etc</span>
  }
}
</code></pre></li>
</ul>
<p><img src="http://code4a.github.io/bimg/better-java-picture2.png" alt="ImmuTable-by-default"></p>
<pre><code><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Thrower</span> </span>{
    <span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">throwIfCondition</span><span class="params">(<span class="keyword">boolean</span> condition, String msg)</span> </span>{
        <span class="comment">// ...</span>
    }
}
</code></pre><ul>
<li><h5 id="这样每个需要使用这些接口的类可以方便的进行自定义">这样每个需要使用这些接口的类可以方便的进行自定义</h5></li>
</ul>
<h4 id="格式化">格式化</h4><p><img src="http://code4a.github.io/bimg/better-java-picture3.png" alt="ImmuTable-by-default"></p>
<h4 id="javaDoc">javaDoc</h4><ul>
<li><h5 id="为你的代码添加javaDoc同样非常重要，可以参考这个示例：using_examples">为你的代码添加javaDoc同样非常重要，可以参考这个示例：using examples</h5></li>
</ul>
<h4 id="Streams">Streams</h4><ul>
<li><h5 id="java_8_提供了非常nice的_stream_api可以用如下的写法：">java 8 提供了非常nice的 stream api可以用如下的写法：</h5><pre><code>final <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; filtered = <span class="built_in">list</span><span class="built_in">.</span>stream()<span class="built_in">.</span>filter(s<span class="subst">-&gt;</span>s<span class="built_in">.</span>startsWith(<span class="string">"s"</span>))<span class="built_in">.</span><span class="built_in">map</span>(s<span class="subst">-&gt;</span>s<span class="built_in">.</span>toUpperCase())<span class="built_in">.</span>collect(Collectors<span class="built_in">.</span>toList());
</code></pre></li>
<li><h5 id="来替代：">来替代：</h5><pre><code><span class="keyword">final</span> List&lt;<span class="keyword">String</span>&gt; filtered = <span class="keyword">new</span> ArrayList&lt;&gt;();
<span class="keyword">for</span> (<span class="keyword">String</span> <span class="built_in">str</span> : list){
    <span class="keyword">if</span>(<span class="built_in">str</span>.startsWith(<span class="string">"s"</span>)){
        filtered.<span class="built_in">add</span>(<span class="built_in">str</span>.toUpperCase());
    }
}
</code></pre></li>
<li><h5 id="这样可以帮助你写更多的高可读性，流畅性的代码。">这样可以帮助你写更多的高可读性，流畅性的代码。</h5></li>
</ul>
<h2 id="本文来自：SegmentFault_版权归属原作者">本文来自：SegmentFault 版权归属原作者</h2>]]></content>
    <summary type="html">
    <![CDATA[<h2 id="教你编写现代化的java程式">教你编写现代化的java程式</h2><blockquote>
<p>Java是目前世界上最流行的编程语言之一，自从java8正式发布之后，原有的编程习惯方式发生了一些转变。</p>
</blockquote>
<h3 id="St]]>
    </summary>
    
      <category term="java, 编程思想" scheme="http://www.code4a.com/tags/java-%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[WheelView Android]]></title>
    <link href="http://www.code4a.com/2015/11/15/WheelView-Android/"/>
    <id>http://www.code4a.com/2015/11/15/WheelView-Android/</id>
    <published>2015-11-15T08:42:11.000Z</published>
    <updated>2015-11-15T09:47:33.000Z</updated>
    <content type="html"><![CDATA[<h2 id="Android_横向滚轮选择视图">Android 横向滚轮选择视图</h2><h4 id="适用于为money_或者短词名称做选择器">适用于为money 或者短词名称做选择器</h4><h4 id="先上图，效果图：">先上图，效果图：</h4><p><img src="https://raw.githubusercontent.com/lantouzi/WheelView-Android/master/preview/demo.jpg" alt="WheelView"></p>
<h4 id="使用方式">使用方式</h4><h5 id="布局xml：">布局xml：</h5><p>  <strong>注意在父布局加入<code>xmlns:app=&quot;http://schemas.android.com/apk/res-auto</code>“可使用自定义属性</strong></p>
<pre><code><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="tag">&lt;<span class="title">ScrollView</span>
  <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span>
  <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span>
  <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span>&gt;</span>

  <span class="tag">&lt;<span class="title">LinearLayout</span>
    <span class="attribute">xmlns:app</span>=<span class="value">"http://schemas.android.com/apk/res-auto"</span>
    <span class="attribute">xmlns:tools</span>=<span class="value">"http://schemas.android.com/tools"</span>
    <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span>
    <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span>
    <span class="attribute">android:background</span>=<span class="value">"#fafafa"</span>
    <span class="attribute">android:orientation</span>=<span class="value">"vertical"</span>
    <span class="attribute">android:weightSum</span>=<span class="value">"2"</span>
    <span class="attribute">tools:context</span>=<span class="value">".MainActivity"</span>&gt;</span>

    <span class="tag">&lt;<span class="title">LinearLayout</span>
      <span class="attribute">android:layout_width</span>=<span class="value">"wrap_content"</span>
      <span class="attribute">android:layout_height</span>=<span class="value">"0dp"</span>
      <span class="attribute">android:layout_weight</span>=<span class="value">"1"</span>
      <span class="attribute">android:orientation</span>=<span class="value">"vertical"</span>&gt;</span>

      <span class="tag">&lt;<span class="title">com.lantouzi.wheelview.WheelView</span>
        <span class="attribute">android:id</span>=<span class="value">"@+id/wheelview"</span>
        <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span>
        <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span>
        <span class="attribute">android:layout_marginTop</span>=<span class="value">"8dp"</span>
        <span class="attribute">android:background</span>=<span class="value">"@android:color/white"</span>/&gt;</span>

      <span class="tag">&lt;<span class="title">com.lantouzi.wheelview.WheelView</span>
        <span class="attribute">android:id</span>=<span class="value">"@+id/wheelview2"</span>
        <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span>
        <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span>
        <span class="attribute">android:layout_marginTop</span>=<span class="value">"8dp"</span>
        <span class="attribute">android:background</span>=<span class="value">"@android:color/white"</span>
        <span class="attribute">app:lwvHighlightColor</span>=<span class="value">"#7CD717"</span>
        <span class="attribute">app:lwvIntervalFactor</span>=<span class="value">"1.1"</span>/&gt;</span>

      <span class="tag">&lt;<span class="title">com.lantouzi.wheelview.WheelView</span>
        <span class="attribute">android:id</span>=<span class="value">"@+id/wheelview3"</span>
        <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span>
        <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span>
        <span class="attribute">android:layout_marginTop</span>=<span class="value">"8dp"</span>
        <span class="attribute">android:background</span>=<span class="value">"@android:color/white"</span>
        <span class="attribute">app:lwvHighlightColor</span>=<span class="value">"#31B1E6"</span>
        <span class="attribute">app:lwvIntervalFactor</span>=<span class="value">"1.3"</span>
        <span class="attribute">app:lwvMarkRatio</span>=<span class="value">"0.2"</span>
        <span class="attribute">app:lwvMarkTextColor</span>=<span class="value">"#919191"</span>/&gt;</span>

    <span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span>

    <span class="tag">&lt;<span class="title">com.lantouzi.wheelview.WheelView</span>
      <span class="attribute">android:id</span>=<span class="value">"@+id/wheelview4"</span>
      <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span>
      <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span>
      <span class="attribute">android:layout_marginTop</span>=<span class="value">"16dp"</span>
      <span class="attribute">android:background</span>=<span class="value">"#222222"</span>
      <span class="attribute">app:lwvAdditionalCenterMark</span>=<span class="value">"元"</span>
      <span class="attribute">app:lwvHighlightColor</span>=<span class="value">"#31B1E6"</span>
      <span class="attribute">app:lwvMarkColor</span>=<span class="value">"#EEEEEE"</span>
      <span class="attribute">app:lwvMarkTextColor</span>=<span class="value">"#CACACA"</span>/&gt;</span>

    <span class="tag">&lt;<span class="title">com.lantouzi.wheelview.WheelView</span>
      <span class="attribute">android:id</span>=<span class="value">"@+id/wheelview5"</span>
      <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span>
      <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span>
      <span class="attribute">android:layout_marginTop</span>=<span class="value">"16dp"</span>
      <span class="attribute">android:background</span>=<span class="value">"#222222"</span>
      <span class="attribute">app:lwvAdditionalCenterMark</span>=<span class="value">"元"</span>
      <span class="attribute">app:lwvCenterMarkTextSize</span>=<span class="value">"14sp"</span>
      <span class="attribute">app:lwvCursorSize</span>=<span class="value">"10dp"</span>
      <span class="attribute">app:lwvHighlightColor</span>=<span class="value">"#31B1E6"</span>
      <span class="attribute">app:lwvMarkColor</span>=<span class="value">"#EEEEEE"</span>
      <span class="attribute">app:lwvMarkTextColor</span>=<span class="value">"#CACACA"</span>
      <span class="attribute">app:lwvMarkTextSize</span>=<span class="value">"12sp"</span>/&gt;</span>

    <span class="tag">&lt;<span class="title">TextView</span>
      <span class="attribute">android:id</span>=<span class="value">"@+id/selected_tv"</span>
      <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span>
      <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span>
      <span class="attribute">android:layout_margin</span>=<span class="value">"8dp"</span>
      <span class="attribute">android:gravity</span>=<span class="value">"center"</span>/&gt;</span>
  <span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span>
<span class="tag">&lt;/<span class="title">ScrollView</span>&gt;</span>
</code></pre><h4 id="Activity中实现:">Activity中实现:</h4><pre><code>  <span class="keyword">private</span> WheelView mWheelView, mWheelView2, mWheelView3, mWheelView4, mWheelView5;
  <span class="keyword">private</span> TextView mSelectedTv;

  @Override
  <span class="keyword">protected</span> <span class="keyword">void</span> onCreate(Bundle savedInstanceState) {
    <span class="keyword">super</span>.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    mWheelView = (WheelView) findViewById(R.id.wheelview);
    mWheelView2 = (WheelView) findViewById(R.id.wheelview2);
    mWheelView3 = (WheelView) findViewById(R.id.wheelview3);
    mWheelView4 = (WheelView) findViewById(R.id.wheelview4);
    mWheelView5 = (WheelView) findViewById(R.id.wheelview5);
    mSelectedTv = (TextView) findViewById(R.id.selected_tv);

    <span class="keyword">final</span> List&lt;<span class="keyword">String</span>&gt; items = <span class="keyword">new</span> ArrayList&lt;&gt;();
    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">40</span>; i++) {
      items.<span class="built_in">add</span>(<span class="keyword">String</span>.valueOf(i * <span class="number">1000</span>));
    }

    mWheelView.setItems(items);
    mWheelView.selectIndex(<span class="number">8</span>);
    mWheelView.setAdditionCenterMark(<span class="string">"元"</span>);

    List&lt;<span class="keyword">String</span>&gt; items2 = <span class="keyword">new</span> ArrayList&lt;&gt;();
    items2.<span class="built_in">add</span>(<span class="string">"一月"</span>);
    items2.<span class="built_in">add</span>(<span class="string">"二月"</span>);
    items2.<span class="built_in">add</span>(<span class="string">"三月"</span>);
    items2.<span class="built_in">add</span>(<span class="string">"四月"</span>);
    items2.<span class="built_in">add</span>(<span class="string">"五月"</span>);
    items2.<span class="built_in">add</span>(<span class="string">"六月"</span>);
    items2.<span class="built_in">add</span>(<span class="string">"七月"</span>);
    items2.<span class="built_in">add</span>(<span class="string">"八月"</span>);
    items2.<span class="built_in">add</span>(<span class="string">"九月"</span>);
    items2.<span class="built_in">add</span>(<span class="string">"十月"</span>);
    items2.<span class="built_in">add</span>(<span class="string">"十一月"</span>);
    items2.<span class="built_in">add</span>(<span class="string">"十二月"</span>);

    mWheelView2.setItems(items2);

    List&lt;<span class="keyword">String</span>&gt; items3 = <span class="keyword">new</span> ArrayList&lt;&gt;();
    items3.<span class="built_in">add</span>(<span class="string">"1"</span>);
    items3.<span class="built_in">add</span>(<span class="string">"2"</span>);
    items3.<span class="built_in">add</span>(<span class="string">"3"</span>);
    items3.<span class="built_in">add</span>(<span class="string">"5"</span>);
    items3.<span class="built_in">add</span>(<span class="string">"7"</span>);
    items3.<span class="built_in">add</span>(<span class="string">"11"</span>);
    items3.<span class="built_in">add</span>(<span class="string">"13"</span>);
    items3.<span class="built_in">add</span>(<span class="string">"17"</span>);
    items3.<span class="built_in">add</span>(<span class="string">"19"</span>);
    items3.<span class="built_in">add</span>(<span class="string">"23"</span>);
    items3.<span class="built_in">add</span>(<span class="string">"29"</span>);
    items3.<span class="built_in">add</span>(<span class="string">"31"</span>);

    mWheelView3.setItems(items3);
    mWheelView3.setAdditionCenterMark(<span class="string">"m"</span>);

    mWheelView4.setItems(items);

    mWheelView5.setItems(items);
    mWheelView5.setOnWheelItemSelectedListener(<span class="keyword">new</span> WheelView.OnWheelItemSelectedListener() {
      @Override
      <span class="keyword">public</span> <span class="keyword">void</span> onWheelItemSelected(<span class="built_in">int</span> position) {
        mSelectedTv.setText(<span class="string">"选择："</span> + items.<span class="built_in">get</span>(position) + <span class="string">"万"</span>);
      }
    });

}
</code></pre><h4 id="引用的wheelview">引用的wheelview</h4><h5 id="attrs-xml">attrs.xml</h5><pre><code><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="tag">&lt;<span class="title">resources</span>&gt;</span>
  <span class="tag">&lt;<span class="title">declare-styleable</span> <span class="attribute">name</span>=<span class="value">"WheelView"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">"lwvHighlightColor"</span> <span class="attribute">format</span>=<span class="value">"color|reference"</span>/&gt;</span>
    <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">"lwvMarkColor"</span> <span class="attribute">format</span>=<span class="value">"color|reference"</span>/&gt;</span>
    <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">"lwvMarkTextColor"</span> <span class="attribute">format</span>=<span class="value">"color|reference"</span>/&gt;</span>
    <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">"lwvIntervalFactor"</span> <span class="attribute">format</span>=<span class="value">"float"</span>/&gt;</span>
    <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">"lwvMarkRatio"</span> <span class="attribute">format</span>=<span class="value">"float"</span>/&gt;</span>
    <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">"lwvCursorSize"</span> <span class="attribute">format</span>=<span class="value">"dimension"</span>/&gt;</span>
    <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">"lwvMarkTextSize"</span> <span class="attribute">format</span>=<span class="value">"dimension"</span>/&gt;</span>
    <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">"lwvCenterMarkTextSize"</span> <span class="attribute">format</span>=<span class="value">"dimension"</span>/&gt;</span>
    <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">"lwvHighlightMarkTextSize"</span> <span class="attribute">format</span>=<span class="value">"dimension"</span>/&gt;</span>
    <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">"lwvAdditionalCenterMark"</span> <span class="attribute">format</span>=<span class="value">"string|reference"</span>/&gt;</span>
  <span class="tag">&lt;/<span class="title">declare-styleable</span>&gt;</span>
<span class="tag">&lt;/<span class="title">resources</span>&gt;</span>
</code></pre><h5 id="自定义视图WheelView">自定义视图WheelView</h5><pre><code>package com.lantouzi.wheelview;

import android.content.Context;
import android.content.res.TypedArray;
import android.graphics.Canvas;
import android.graphics.Paint;
import android.graphics.Path;
import android.graphics.Rect;
import android.graphics.RectF;
import android.os.Parcel;
import android.os.Parcelable;
import android.support.v4.view.GestureDetectorCompat;
import android.support.v4.view.ViewCompat;
import android.text.TextPaint;
import android.text.TextUtils;
import android.util.AttributeSet;
import android.view.GestureDetector;
import android.view.MotionEvent;
import android.view.SoundEffectConstants;
import android.view.View;
import android.widget.OverScroller;

import com.lantouzi.wheelview.library.R;

import java.util.List;

<span class="comment">/**
* Created by kyle on 15/11/9.
*/</span>
<span class="keyword">public</span> <span class="keyword">class</span> WheelView extends View implements GestureDetector.OnGestureListener {
  <span class="keyword">public</span> <span class="keyword">static</span> final <span class="keyword">float</span> DEFAULT_INTERVAL_FACTOR = <span class="number">1.2f</span>;
  <span class="keyword">public</span> <span class="keyword">static</span> final <span class="keyword">float</span> DEFAULT_MARK_RATIO = <span class="number">0.7f</span>;

  <span class="keyword">private</span> Paint mMarkPaint;
  <span class="keyword">private</span> TextPaint mMarkTextPaint;
  <span class="keyword">private</span> <span class="keyword">int</span> mCenterIndex;

  <span class="keyword">private</span> <span class="keyword">int</span> mHighlightColor, mMarkTextColor;
  <span class="keyword">private</span> <span class="keyword">int</span> mMarkColor, mFadeMarkColor;

  <span class="keyword">private</span> <span class="keyword">int</span> mHeight;
  <span class="keyword">private</span> List&lt;String&gt; mItems;
  <span class="keyword">private</span> String mAdditionCenterMark;
  <span class="keyword">private</span> OnWheelItemSelectedListener mOnWheelItemSelectedListener;
  <span class="keyword">private</span> <span class="keyword">float</span> mIntervalFactor = DEFAULT_INTERVAL_FACTOR;
  <span class="keyword">private</span> <span class="keyword">float</span> mMarkRatio = DEFAULT_MARK_RATIO;

  <span class="keyword">private</span> <span class="keyword">int</span> mMarkCount;
  <span class="keyword">private</span> <span class="keyword">float</span> mAdditionCenterMarkWidth;
  <span class="keyword">private</span> Path mCenterIndicatorPath = <span class="keyword">new</span> Path();
  <span class="keyword">private</span> <span class="keyword">float</span> mCursorSize;
  <span class="keyword">private</span> <span class="keyword">int</span> mViewScopeSize;

  <span class="comment">// scroll control args ---- start</span>
  <span class="keyword">private</span> OverScroller mScroller;
  <span class="keyword">private</span> <span class="keyword">float</span> mMaxOverScrollDistance;
  <span class="keyword">private</span> RectF mContentRectF;
  <span class="keyword">private</span> boolean mFling = <span class="literal">false</span>;
  <span class="keyword">private</span> <span class="keyword">float</span> mCenterTextSize, mNormalTextSize;
  <span class="keyword">private</span> <span class="keyword">float</span> mTopSpace, mBottomSpace;
  <span class="keyword">private</span> <span class="keyword">float</span> mIntervalDis;
  <span class="keyword">private</span> <span class="keyword">float</span> mCenterMarkWidth, mMarkWidth;
  <span class="keyword">private</span> GestureDetectorCompat mGestureDetectorCompat;
  <span class="comment">// scroll control args ---- end</span>


  <span class="function"><span class="keyword">public</span> <span class="title">WheelView</span><span class="params">(Context context)</span> </span>{
    super(context);
    init(null);
  }

  <span class="function"><span class="keyword">public</span> <span class="title">WheelView</span><span class="params">(Context context, AttributeSet attrs)</span> </span>{
    super(context, attrs);
    init(attrs);
  }

  <span class="function"><span class="keyword">public</span> <span class="title">WheelView</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>{
    super(context, attrs, defStyleAttr);
    init(attrs);
  }

  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(AttributeSet attrs)</span> </span>{
    <span class="keyword">float</span> density = getResources().getDisplayMetrics().density;
    mCenterMarkWidth = (<span class="keyword">int</span>) (density * <span class="number">1.5f</span> + <span class="number">0.5f</span>);
    mMarkWidth = density;

    mHighlightColor = <span class="number">0xFFF74C39</span>;
    mMarkTextColor = <span class="number">0xFF666666</span>;
    mMarkColor = <span class="number">0xFFEEEEEE</span>;
    mCursorSize = density * <span class="number">18</span>;
    mCenterTextSize = density * <span class="number">22</span>;
    mNormalTextSize = density * <span class="number">18</span>;
    mBottomSpace = density * <span class="number">6</span>;

    TypedArray ta = attrs == null ? null : getContext().obtainStyledAttributes(attrs, R.styleable.WheelView);
    <span class="keyword">if</span> (ta != null) {
      mHighlightColor = ta.getColor(R.styleable.WheelView_lwvHighlightColor, mHighlightColor);
      mMarkTextColor = ta.getColor(R.styleable.WheelView_lwvMarkTextColor, mMarkTextColor);
      mMarkColor = ta.getColor(R.styleable.WheelView_lwvMarkColor, mMarkColor);
      mIntervalFactor = ta.getFloat(R.styleable.WheelView_lwvIntervalFactor, mIntervalFactor);
      mMarkRatio = ta.getFloat(R.styleable.WheelView_lwvMarkRatio, mMarkRatio);
      mAdditionCenterMark = ta.getString(R.styleable.WheelView_lwvAdditionalCenterMark);
      mCenterTextSize = ta.getDimension(R.styleable.WheelView_lwvCenterMarkTextSize, mCenterTextSize);
      mNormalTextSize = ta.getDimension(R.styleable.WheelView_lwvMarkTextSize, mNormalTextSize);
      mCursorSize = ta.getDimension(R.styleable.WheelView_lwvCursorSize, mCursorSize);
    }
    mFadeMarkColor = mHighlightColor &amp; <span class="number">0xAAFFFFFF</span>;
    mIntervalFactor = Math.max(<span class="number">1</span>, mIntervalFactor);
    mMarkRatio = Math.min(<span class="number">1</span>, mMarkRatio);
    mTopSpace = mCursorSize + density * <span class="number">2</span>;

    mMarkPaint = <span class="keyword">new</span> Paint(Paint.ANTI_ALIAS_FLAG);
    mMarkTextPaint = <span class="keyword">new</span> TextPaint(Paint.ANTI_ALIAS_FLAG);
    mMarkTextPaint.setTextAlign(Paint.Align.CENTER);
    mMarkTextPaint.setColor(mHighlightColor);

    mMarkPaint.setColor(mMarkColor);
    mMarkPaint.setStrokeWidth(mCenterMarkWidth);

    mMarkTextPaint.setTextSize(mCenterTextSize);
    calcIntervalDis();

    mScroller = <span class="keyword">new</span> OverScroller(getContext());
    mContentRectF = <span class="keyword">new</span> RectF();

    mGestureDetectorCompat = <span class="keyword">new</span> GestureDetectorCompat(getContext(), <span class="keyword">this</span>);

    selectIndex(<span class="number">0</span>);
  }

  <span class="comment">/**
   * calculate interval distance between items
   */</span>
  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">calcIntervalDis</span><span class="params">()</span> </span>{
    <span class="keyword">if</span> (mMarkTextPaint == null) {
      <span class="keyword">return</span>;
    }
    String defaultText = <span class="string">"888888"</span>;
    Rect temp = <span class="keyword">new</span> Rect();
    <span class="keyword">int</span> max = <span class="number">0</span>;
    <span class="keyword">if</span> (mItems != null &amp;&amp; mItems.size() &gt; <span class="number">0</span>) {
      <span class="keyword">for</span> (String i : mItems) {
        mMarkTextPaint.getTextBounds(i, <span class="number">0</span>, i.length(), temp);
        <span class="keyword">if</span> (temp.width() &gt; max) {
          max = temp.width();
        }
      }
    } <span class="keyword">else</span> {
      mMarkTextPaint.getTextBounds(defaultText, <span class="number">0</span>, defaultText.length(), temp);
      max = temp.width();
    }

    <span class="keyword">if</span> (!TextUtils.isEmpty(mAdditionCenterMark)) {
      mMarkTextPaint.setTextSize(mNormalTextSize);
      mMarkTextPaint.getTextBounds(mAdditionCenterMark, <span class="number">0</span>, mAdditionCenterMark.length(), temp);
      mAdditionCenterMarkWidth = temp.width();
      max += temp.width();
    }

    mIntervalDis = max * mIntervalFactor;
  }

  @<span class="function">Override
  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onMeasure</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec, <span class="keyword">int</span> heightMeasureSpec)</span> </span>{
    setMeasuredDimension(measureWidth(widthMeasureSpec), measureHeight(heightMeasureSpec));
  }

  <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">measureWidth</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec)</span> </span>{
    <span class="keyword">int</span> measureMode = MeasureSpec.getMode(widthMeasureSpec);
    <span class="keyword">int</span> measureSize = MeasureSpec.getSize(widthMeasureSpec);
    <span class="keyword">int</span> result = getSuggestedMinimumWidth();
    <span class="keyword">switch</span> (measureMode) {
      <span class="keyword">case</span> MeasureSpec.AT_MOST:
      <span class="keyword">case</span> MeasureSpec.EXACTLY:
        result = measureSize;
        <span class="keyword">break</span>;
      <span class="keyword">default</span>:
        <span class="keyword">break</span>;
    }
    <span class="keyword">return</span> result;
  }

  <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">measureHeight</span><span class="params">(<span class="keyword">int</span> heightMeasure)</span> </span>{
    <span class="keyword">int</span> measureMode = MeasureSpec.getMode(heightMeasure);
    <span class="keyword">int</span> measureSize = MeasureSpec.getSize(heightMeasure);
    <span class="keyword">int</span> result = (<span class="keyword">int</span>) (mBottomSpace + mTopSpace * <span class="number">2</span> + mCenterTextSize);
    <span class="keyword">switch</span> (measureMode) {
      <span class="keyword">case</span> MeasureSpec.EXACTLY:
        result = Math.max(result, measureSize);
        <span class="keyword">break</span>;
      <span class="keyword">case</span> MeasureSpec.AT_MOST:
        result = Math.min(result, measureSize);
        <span class="keyword">break</span>;
      <span class="keyword">default</span>:
        <span class="keyword">break</span>;
    }
    <span class="keyword">return</span> result;
  }

  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fling</span><span class="params">(<span class="keyword">int</span> velocityX, <span class="keyword">int</span> velocityY)</span> </span>{
    mScroller.fling(getScrollX(), getScrollY(), velocityX, velocityY, (<span class="keyword">int</span>) -mMaxOverScrollDistance, (<span class="keyword">int</span>) (mContentRectF.width() - mMaxOverScrollDistance), <span class="number">0</span>, <span class="number">0</span>, (<span class="keyword">int</span>) mMaxOverScrollDistance, <span class="number">0</span>);
    ViewCompat.postInvalidateOnAnimation(<span class="keyword">this</span>);
  }

  @<span class="function">Override
  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onSizeChanged</span><span class="params">(<span class="keyword">int</span> w, <span class="keyword">int</span> h, <span class="keyword">int</span> oldw, <span class="keyword">int</span> oldh)</span> </span>{
    super.onSizeChanged(w, h, oldw, oldh);
    <span class="keyword">if</span> (w != oldw || h != oldh) {
      mHeight = h;
      mMaxOverScrollDistance = w / <span class="number">2.f</span>;
      mContentRectF.<span class="built_in">set</span>(<span class="number">0</span>, <span class="number">0</span>, (mMarkCount - <span class="number">1</span>) * mIntervalDis, h);
      mViewScopeSize = (<span class="keyword">int</span>) Math.<span class="built_in">ceil</span>(mMaxOverScrollDistance / mIntervalDis);
    }
  }

  @<span class="function">Override
  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>{
    super.onDraw(canvas);

    mCenterIndicatorPath.reset();
    <span class="keyword">float</span> sizeDiv2 = mCursorSize / <span class="number">2f</span>;
    <span class="keyword">float</span> sizeDiv3 = mCursorSize / <span class="number">3f</span>;
    mCenterIndicatorPath.moveTo(mMaxOverScrollDistance - sizeDiv2 + getScrollX(), <span class="number">0</span>);
    mCenterIndicatorPath.rLineTo(<span class="number">0</span>, sizeDiv3);
    mCenterIndicatorPath.rLineTo(sizeDiv2, sizeDiv2);
    mCenterIndicatorPath.rLineTo(sizeDiv2, -sizeDiv2);
    mCenterIndicatorPath.rLineTo(<span class="number">0</span>, -sizeDiv3);
    mCenterIndicatorPath.close();

    mMarkPaint.setColor(mHighlightColor);
    canvas.drawPath(mCenterIndicatorPath, mMarkPaint);

    <span class="keyword">int</span> start = mCenterIndex - mViewScopeSize;
    <span class="keyword">int</span> end = mCenterIndex + mViewScopeSize + <span class="number">1</span>;

    start = Math.max(start, -mViewScopeSize * <span class="number">2</span>);
    end = Math.min(end, mMarkCount + mViewScopeSize * <span class="number">2</span>);

    <span class="comment">// extends both ends</span>
    <span class="keyword">if</span> (mCenterIndex == mMarkCount - <span class="number">1</span>) {
      end += mViewScopeSize;
    } <span class="keyword">else</span> <span class="keyword">if</span> (mCenterIndex == <span class="number">0</span>) {
      start -= mViewScopeSize;
    }

    <span class="keyword">float</span> x = start * mIntervalDis;

    <span class="keyword">float</span> markHeight =  mHeight - mBottomSpace - mCenterTextSize - mTopSpace;
    <span class="comment">// small scale Y offset</span>
    <span class="keyword">float</span> smallMarkShrinkY = markHeight * (<span class="number">1</span> - mMarkRatio) / <span class="number">2f</span>;
    smallMarkShrinkY = Math.min((markHeight - mMarkWidth) / <span class="number">2f</span>, smallMarkShrinkY);

    <span class="keyword">for</span> (<span class="keyword">int</span> i = start; i &lt; end; i++) {
      <span class="keyword">float</span> tempDis = mIntervalDis / <span class="number">5f</span>;
      <span class="comment">// offset: Small mark offset Big mark</span>
      <span class="keyword">for</span> (<span class="keyword">int</span> offset = -<span class="number">2</span>; offset &lt; <span class="number">3</span>; offset++) {
        <span class="keyword">float</span> ox = x + offset * tempDis;

        <span class="keyword">if</span> (i &gt;= <span class="number">0</span> &amp;&amp; i &lt;= mMarkCount &amp;&amp; mCenterIndex == i) {
          <span class="keyword">int</span> tempOffset = Math.<span class="built_in">abs</span>(offset);
          <span class="keyword">if</span> (tempOffset == <span class="number">0</span>) {
            mMarkPaint.setColor(mHighlightColor);
          } <span class="keyword">else</span> <span class="keyword">if</span> (tempOffset == <span class="number">1</span>) {
            mMarkPaint.setColor(mFadeMarkColor);
          } <span class="keyword">else</span> {
            mMarkPaint.setColor(mMarkColor);
          }
        } <span class="keyword">else</span> {
          mMarkPaint.setColor(mMarkColor);
        }

        <span class="keyword">if</span> (offset == <span class="number">0</span>) {
          <span class="comment">// center mark</span>
          mMarkPaint.setStrokeWidth(mCenterMarkWidth);
          canvas.drawLine(ox, mTopSpace, ox, mTopSpace + markHeight, mMarkPaint);
        } <span class="keyword">else</span> {
          <span class="comment">// other small mark</span>
          mMarkPaint.setStrokeWidth(mMarkWidth);
          canvas.drawLine(ox, mTopSpace + smallMarkShrinkY, ox, mTopSpace + markHeight - smallMarkShrinkY, mMarkPaint);
        }
      }

      <span class="comment">// mark text</span>
      <span class="keyword">if</span> (mMarkCount &gt; <span class="number">0</span> &amp;&amp; i &gt;= <span class="number">0</span> &amp;&amp; i &lt; mMarkCount) {
        CharSequence temp = mItems.get(i);
        <span class="keyword">if</span> (mCenterIndex == i) {
          mMarkTextPaint.setColor(mHighlightColor);
          mMarkTextPaint.setTextSize(mCenterTextSize);
          <span class="keyword">if</span> (!TextUtils.isEmpty(mAdditionCenterMark)) {
            <span class="keyword">float</span> off = mAdditionCenterMarkWidth / <span class="number">2f</span>;
            <span class="keyword">float</span> tsize = mMarkTextPaint.measureText(temp, <span class="number">0</span>, temp.length());
            canvas.drawText(temp, <span class="number">0</span>, temp.length(), x - off, mHeight - mBottomSpace, mMarkTextPaint);
            mMarkTextPaint.setTextSize(mNormalTextSize);
            canvas.drawText(mAdditionCenterMark, x + tsize / <span class="number">2f</span>, mHeight - mBottomSpace, mMarkTextPaint);
          } <span class="keyword">else</span> {
            canvas.drawText(temp, <span class="number">0</span>, temp.length(), x, mHeight - mBottomSpace, mMarkTextPaint);
          }
        } <span class="keyword">else</span> {
          mMarkTextPaint.setColor(mMarkTextColor);
          mMarkTextPaint.setTextSize(mNormalTextSize);
          canvas.drawText(temp, <span class="number">0</span>, temp.length(), x, mHeight - mBottomSpace, mMarkTextPaint);
        }
      }

      x += mIntervalDis;
    }
  }

  @<span class="function">Override
  <span class="keyword">public</span> boolean <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>{
    <span class="keyword">if</span> (mItems == null || mItems.size() == <span class="number">0</span>) {
      <span class="keyword">return</span> <span class="literal">false</span>;
    }
    boolean ret = mGestureDetectorCompat.onTouchEvent(event);
    <span class="keyword">if</span> (!mFling &amp;&amp; MotionEvent.ACTION_UP == event.getAction()) {
      <span class="keyword">if</span> (getScrollX() &lt; -mMaxOverScrollDistance) {
        mScroller.startScroll(getScrollX(), <span class="number">0</span>, (<span class="keyword">int</span>) -mMaxOverScrollDistance - getScrollX(), <span class="number">0</span>);
        invalidate();
        ret = <span class="literal">true</span>;
      } <span class="keyword">else</span> <span class="keyword">if</span> (getScrollX() &gt; mContentRectF.width() - mMaxOverScrollDistance) {
        mScroller.startScroll(getScrollX(), <span class="number">0</span>, (<span class="keyword">int</span>) (mContentRectF.width() - mMaxOverScrollDistance) - getScrollX(), <span class="number">0</span>);
        invalidate();
        ret = <span class="literal">true</span>;
      } <span class="keyword">else</span> {
        autoSettle();
        ret = <span class="literal">true</span>;
      }
    }
    <span class="keyword">return</span> ret || super.onTouchEvent(event);
  }

  @<span class="function">Override
  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">computeScroll</span><span class="params">()</span> </span>{
    super.computeScroll();
    <span class="keyword">if</span> (mScroller.computeScrollOffset()) {
      scrollTo(mScroller.getCurrX(), mScroller.getCurrY());
      refreshCenter();
      invalidate();
    } <span class="keyword">else</span> {
      <span class="keyword">if</span> (mFling) {
        mFling = <span class="literal">false</span>;
        autoSettle();
      }
    }
  }

  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAdditionCenterMark</span><span class="params">(String additionCenterMark)</span> </span>{
    mAdditionCenterMark = additionCenterMark;
    calcIntervalDis();
    invalidate();
  }

  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">autoSettle</span><span class="params">()</span> </span>{
    <span class="keyword">int</span> sx = getScrollX();
    <span class="keyword">float</span> dx = mCenterIndex * mIntervalDis - sx - mMaxOverScrollDistance;
    mScroller.startScroll(sx, <span class="number">0</span>, (<span class="keyword">int</span>) dx, <span class="number">0</span>);
    invalidate();
  }

  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">refreshCenter</span><span class="params">(<span class="keyword">int</span> offsetX)</span> </span>{
    <span class="keyword">int</span> offset = (<span class="keyword">int</span>) (offsetX + mMaxOverScrollDistance);
    mCenterIndex = Math.round(offset / mIntervalDis);
    <span class="keyword">if</span> (mCenterIndex &lt; <span class="number">0</span>) {
      mCenterIndex = <span class="number">0</span>;
    } <span class="keyword">else</span> <span class="keyword">if</span> (mCenterIndex &gt; mMarkCount - <span class="number">1</span>) {
      mCenterIndex = mMarkCount - <span class="number">1</span>;
    }
    <span class="keyword">if</span> (null != mOnWheelItemSelectedListener) {
      mOnWheelItemSelectedListener.onWheelItemSelected(mCenterIndex);
    }
  }

  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">refreshCenter</span><span class="params">()</span> </span>{
    refreshCenter(getScrollX());
  }

  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selectIndex</span><span class="params">(<span class="keyword">int</span> index)</span> </span>{
    mCenterIndex = index;
    post(<span class="keyword">new</span> Runnable() {
      @<span class="function">Override
      <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{
        scrollTo((<span class="keyword">int</span>) (mCenterIndex * mIntervalDis - mMaxOverScrollDistance), <span class="number">0</span>);
        invalidate();
        refreshCenter();
      }
    });
  }

  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">smoothSelectIndex</span><span class="params">(<span class="keyword">int</span> index)</span> </span>{
    <span class="keyword">if</span> (!mScroller.isFinished()) {
      mScroller.abortAnimation();
    }
    <span class="keyword">int</span> deltaIndex = index - mCenterIndex;
    mScroller.startScroll(getScrollX(), <span class="number">0</span>, (<span class="keyword">int</span>) (deltaIndex * mIntervalDis), <span class="number">0</span>);
    invalidate();
  }

  <span class="keyword">public</span> List&lt;String&gt; getItems() {
    <span class="keyword">return</span> mItems;
  }

  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setItems</span><span class="params">(List&lt;String&gt; items)</span> </span>{
    mItems = items;
    mMarkCount = null == mItems ? <span class="number">0</span> : mItems.size();
    mCenterIndex = Math.min(mCenterIndex, mMarkCount);
    calcIntervalDis();
    invalidate();
  }

  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSelectedPosition</span><span class="params">()</span> </span>{
    <span class="keyword">return</span> mCenterIndex;
  }

  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnWheelItemSelectedListener</span><span class="params">(OnWheelItemSelectedListener onWheelItemSelectedListener)</span> </span>{
    mOnWheelItemSelectedListener = onWheelItemSelectedListener;
  }

  @<span class="function">Override
  <span class="keyword">public</span> boolean <span class="title">onDown</span><span class="params">(MotionEvent e)</span> </span>{
    <span class="keyword">if</span> (!mScroller.isFinished()) {
      mScroller.forceFinished(<span class="literal">false</span>);
    }
    mFling = <span class="literal">false</span>;
    <span class="keyword">if</span> (null != getParent()) {
      getParent().requestDisallowInterceptTouchEvent(<span class="literal">true</span>);
    }
    <span class="keyword">return</span> <span class="literal">true</span>;
  }

  @<span class="function">Override
  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onShowPress</span><span class="params">(MotionEvent e)</span> </span>{

  }

  @<span class="function">Override
  <span class="keyword">public</span> boolean <span class="title">onSingleTapUp</span><span class="params">(MotionEvent e)</span> </span>{
    playSoundEffect(SoundEffectConstants.CLICK);
    refreshCenter((<span class="keyword">int</span>) (getScrollX() + e.getX() - mMaxOverScrollDistance));
    autoSettle();
    <span class="keyword">return</span> <span class="literal">true</span>;
  }

  @<span class="function">Override
  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onLongPress</span><span class="params">(MotionEvent e)</span> </span>{
  }

  @<span class="function">Override
  <span class="keyword">public</span> boolean <span class="title">onScroll</span><span class="params">(MotionEvent e1, MotionEvent e2, <span class="keyword">float</span> distanceX, <span class="keyword">float</span> distanceY)</span> </span>{
    <span class="keyword">float</span> dis = distanceX;
    <span class="keyword">float</span> scrollX = getScrollX();
    <span class="keyword">if</span> (scrollX &lt; <span class="number">2</span> * -mMaxOverScrollDistance) {
      dis = <span class="number">0</span>;
    } <span class="keyword">else</span> <span class="keyword">if</span> (scrollX &lt; -mMaxOverScrollDistance) {
      dis = distanceX / <span class="number">4.f</span>;
    } <span class="keyword">else</span> <span class="keyword">if</span> (scrollX &gt; mContentRectF.width()) {
      dis = <span class="number">0</span>;
    } <span class="keyword">else</span> <span class="keyword">if</span> (scrollX &gt; mContentRectF.width() - mMaxOverScrollDistance) {
      dis = distanceX / <span class="number">4.f</span>;
    }
    scrollBy((<span class="keyword">int</span>) dis, <span class="number">0</span>);
    refreshCenter();
    <span class="keyword">return</span> <span class="literal">true</span>;
  }

  @<span class="function">Override
  <span class="keyword">public</span> boolean <span class="title">onFling</span><span class="params">(MotionEvent e1, MotionEvent e2, <span class="keyword">float</span> velocityX, <span class="keyword">float</span> velocityY)</span> </span>{
    <span class="keyword">float</span> scrollX = getScrollX();
    <span class="keyword">if</span> (scrollX &lt; -mMaxOverScrollDistance || scrollX &gt; mContentRectF.width() - mMaxOverScrollDistance) {
      <span class="keyword">return</span> <span class="literal">false</span>;
    } <span class="keyword">else</span> {
      mFling = <span class="literal">true</span>;
      fling((<span class="keyword">int</span>) -velocityX, <span class="number">0</span>);
      <span class="keyword">return</span> <span class="literal">true</span>;
    }
  }

  @<span class="function">Override
  <span class="keyword">public</span> Parcelable <span class="title">onSaveInstanceState</span><span class="params">()</span> </span>{
    Parcelable superState = super.onSaveInstanceState();
    SavedState ss = <span class="keyword">new</span> SavedState(superState);
    ss.index = getSelectedPosition();
    <span class="keyword">return</span> ss;
  }

  @<span class="function">Override
  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRestoreInstanceState</span><span class="params">(Parcelable state)</span> </span>{
    SavedState ss = (SavedState) state;
    super.onRestoreInstanceState(ss.getSuperState());
    selectIndex(ss.index);
    requestLayout();
  }

  <span class="keyword">static</span> <span class="keyword">class</span> SavedState extends BaseSavedState {
    <span class="keyword">int</span> index;
    <span class="keyword">public</span> <span class="keyword">static</span> final Parcelable.Creator&lt;SavedState&gt; CREATOR
        = <span class="keyword">new</span> Parcelable.Creator&lt;SavedState&gt;() {
      <span class="function"><span class="keyword">public</span> SavedState <span class="title">createFromParcel</span><span class="params">(Parcel in)</span> </span>{
        <span class="keyword">return</span> <span class="keyword">new</span> SavedState(in);
      }

      <span class="keyword">public</span> SavedState[] newArray(<span class="keyword">int</span> size) {
        <span class="keyword">return</span> <span class="keyword">new</span> SavedState[size];
      }
    };
    SavedState(Parcelable superState) {
      super(superState);
    }

    <span class="function"><span class="keyword">private</span> <span class="title">SavedState</span><span class="params">(Parcel in)</span> </span>{
      super(in);
      index = (<span class="keyword">int</span>) in.readValue(null);
    }

    @<span class="function">Override
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeToParcel</span><span class="params">(Parcel out, <span class="keyword">int</span> flags)</span> </span>{
      super.writeToParcel(out, flags);
      out.writeValue(index);
    }

    @<span class="function">Override
    <span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>{
      <span class="keyword">return</span> <span class="string">"WheelView.SavedState{"</span>
          + Integer.toHexString(System.identityHashCode(<span class="keyword">this</span>))
          + <span class="string">" index="</span> + index + <span class="string">"}"</span>;
    }
  }

  <span class="keyword">public</span> interface OnWheelItemSelectedListener {
    <span class="function"><span class="keyword">void</span> <span class="title">onWheelItemSelected</span><span class="params">(<span class="keyword">int</span> position)</span></span>;
  }
}
</code></pre><h2 id="致谢：">致谢：</h2><p>  <a href="https://github.com/lantouzi/WheelView-Android" target="_blank" rel="external">lantouzi的WheelView-Android</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="Android_横向滚轮选择视图">Android 横向滚轮选择视图</h2><h4 id="适用于为money_或者短词名称做选择器">适用于为money 或者短词名称做选择器</h4><h4 id="先上图，效果图：">先上图，效果图：</h4><p><img]]>
    </summary>
    
      <category term="Android, github" scheme="http://www.code4a.com/tags/Android-github/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[添加网易云音乐]]></title>
    <link href="http://www.code4a.com/2015/11/13/music-163/"/>
    <id>http://www.code4a.com/2015/11/13/music-163/</id>
    <published>2015-11-12T16:44:45.000Z</published>
    <updated>2015-11-13T13:32:37.000Z</updated>
    <content type="html"><![CDATA[<h3 id="为个人博客添加网易云音乐">为个人博客添加网易云音乐</h3><h4 id="首先进入到网易云音乐">首先进入到<a href="http://music.163.com/" target="_blank" rel="external">网易云音乐</a></h4><h4 id="然后可以创建新的歌单，也可使用已有的歌单">然后可以创建新的歌单，也可使用已有的歌单</h4><p><img src="http://code4a.github.io/bimg/music-163-picture1.png" alt="music-163-picture1"></p>
<h4 id="点击生成外链播放器，调整如下图界面">点击生成外链播放器，调整如下图界面</h4><p><img src="http://code4a.github.io/bimg/music-163-picture2.png" alt="music-163-picture2"></p>
<h4 id="复制下边的html代码直接粘贴到markdown文件中即可">复制下边的html代码直接粘贴到markdown文件中即可</h4><p><img src="http://code4a.github.io/bimg/music-163-picture3.png" alt="music-163-picture3"></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="为个人博客添加网易云音乐">为个人博客添加网易云音乐</h3><h4 id="首先进入到网易云音乐">首先进入到<a href="http://music.163.com/" target="_blank" rel="external">网易云音乐</a></h4]]>
    </summary>
    
      <category term="hexo" scheme="http://www.code4a.com/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Hexo + github创建个人博客]]></title>
    <link href="http://www.code4a.com/2015/11/12/hexo-help-page/"/>
    <id>http://www.code4a.com/2015/11/12/hexo-help-page/</id>
    <published>2015-11-11T16:11:45.000Z</published>
    <updated>2015-11-13T13:33:14.000Z</updated>
    <content type="html"><![CDATA[<h2 id="在Mac上安装hexo打造个人博客">在Mac上安装hexo打造个人博客</h2><blockquote>
<p>我起初用的是jekyll ＋ github pages的方式建立个人博客，也是一直用的这种方式维护，<br>略微有些强迫症的我总觉得这种方式不是很满意，而且整个主题也是修改的<br><a href="http://yongyuan.name" target="_blank" rel="external">http://yongyuan.name</a>的模版，其中大部分细节自己也不是很清楚该怎么处理<br>，所以并不是很适合自己的style。后来看到啦 <strong><a href="http://www.aswifter.com/" target="_blank" rel="external">阳春面</a></strong> 的博客觉得主题和模版<br>都很棒，并且在手机上也可以自适应，非常的棒，所以就一眼相中啦，刚好这段时间，我又将自己的<a href="https://github.com/code4s" target="_blank" rel="external">github</a>的用户名改了一下<br>，导致原有的博客也无法使用，所以就直接用了 <strong><a href="http://www.aswifter.com/" target="_blank" rel="external">阳春面</a></strong> 的这种方式重新建立个人博客</p>
</blockquote>
<h4 id="问题一：安装node-js">问题一：安装node.js</h4><h5 id="根据_Hexo官方文档_进行配置遇到了一些问题，在此做些纪录避免再次遇到时还需要花费大量时间去搜索问题。">根据 <strong><a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="external">Hexo官方文档</a></strong> 进行配置遇到了一些问题，在此做些纪录避免再次遇到时还需要花费大量时间去搜索问题。</h5><blockquote>
<p>文档中通过nvm的方式安装node.js 而安装nvm的两种方式curl和wget尝试均失败啦，第一种是下载依赖总是失败，<br>第二种wget这个前提需要安装wget，而wget也是需要提前安装一些依赖，尝试好久，还是失败。最后没办法直接<br>从 <strong><a href="https://nodejs.org/en/" target="_blank" rel="external">Node.js</a></strong> 网站下载pkg进行安装，此时node 和 npm 都成功安装，省去不少麻烦。</p>
</blockquote>
<h4 id="问题二：安装hexo">问题二：安装hexo</h4><h5 id="此时使用_npm_install_-g_hexo-cli_会出现权限相关的问题，根据出现的问题google，baidu给出的方案都是无法解决">此时使用 <code>npm install -g hexo-cli</code> 会出现权限相关的问题，根据出现的问题google，baidu给出的方案都是无法解决</h5><p>  最终在<strong><a href="https://github.com/hexojs/hexo/issues/913" target="_blank" rel="external">hexojs/hexo</a></strong> 中尝试成功. 使用 <code>sudo npm install -g -unsafe-perm hexo</code> 安装成功！随即将容易出现的几个点标记一下，防止下次再犯，也可帮助出现同样问题的童鞋尽快找到答案。</p>
<h3 id="所有的问题回头看看也没有什么太复杂的，万事开头难。遇到问题需要的还是耐心，有耐心终会找打解决方案！">所有的问题回头看看也没有什么太复杂的，万事开头难。遇到问题需要的还是耐心，有耐心终会找打解决方案！</h3><h4 id="使用jacman主题如何自定义多说">使用jacman主题如何自定义多说</h4><h5 id="HelloDog的文章中描述啦本地化多说embed-js，但是具体代码块的位置不是很容易找到，再次记录一下。">HelloDog的文章中描述啦本地化多说embed.js，但是具体代码块的位置不是很容易找到，再次记录一下。</h5><pre><code><span class="regexp">/.../</span>themes<span class="regexp">/jacman/</span>layout<span class="regexp">/_partial/</span>after_footer.ejs
</code></pre><p>  找到其中的多说的js代码修改即可</p>
<h3 id="参考致谢">参考致谢</h3><ol>
<li><a href="http://wuchong.me/blog/2014/11/20/how-to-use-jacman/" target="_blank" rel="external">Jark’s Blog如何使用 Jacman 主题</a></li>
<li><a href="http://wsgzao.github.io/post/hexo-jacman/" target="_blank" rel="external">HelloDog Jacman基于Pacman修改的Hexo主题</a></li>
<li><a href="http://quantumman.me/blog/setting-up-a-domain-with-gitHub-pages.html" target="_blank" rel="external">GitHub Pages 绑定来自阿里云的域名</a></li>
<li><a href="http://wsgzao.github.io/post/duoshuo/" target="_blank" rel="external">多说自定义CSS动感头像和多说评论显示User Agent的那些小事</a></li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="在Mac上安装hexo打造个人博客">在Mac上安装hexo打造个人博客</h2><blockquote>
<p>我起初用的是jekyll ＋ github pages的方式建立个人博客，也是一直用的这种方式维护，<br>略微有些强迫症的我总觉得这种方式不是很满意]]>
    </summary>
    
      <category term="hexo" scheme="http://www.code4a.com/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Hello World]]></title>
    <link href="http://www.code4a.com/2015/11/11/hello-world/"/>
    <id>http://www.code4a.com/2015/11/11/hello-world/</id>
    <published>2015-11-11T13:44:55.000Z</published>
    <updated>2015-11-11T13:44:55.000Z</updated>
    <content type="html"><![CDATA[<p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick_Start">Quick Start</h2><h3 id="Create_a_new_post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run_server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate_static_files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy_to_remote_sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io]]>
    </summary>
    
  </entry>
  
</feed>
